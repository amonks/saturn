{"version":3,"sources":["main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["// main.js\n\n/* global $ Saturn Handlebars Analyst */\n\n$(function () {\n\n  let render = function (data) {\n    console.log('rendering')\n    $('#analysis').addClass('hidden')\n    $('#data').empty()\n\n    if (data.length > 0) {\n      $('#analysis').removeClass('hidden')\n\n      let analysis = analyst.analyze(data)\n\n      for (let tag in analysis.counts) {\n        let count = analysis.counts[tag]\n        let html = Handlebars.templates.analysis({\n          count: count,\n          tag: tag,\n          percentage: (count * 100) / analysis.total | 0\n        })\n        $('#data').append(html)\n      }\n    }\n  }\n\n  // play a sound\n  let snd = false\n  let ping = function () {\n    console.log('pinging')\n    snd = snd || new window.Audio('ping.mp3')\n    snd.play()\n  }\n\n  // show browser notification\n  let notify = function (text) {\n    console.log('notify: ', text)\n    // Let's check if the browser supports notifications\n    if (!('Notification' in window)) {\n      return false\n\n    // Let's check whether notification permissions have already been granted\n    } else if (window.Notification.permission === 'granted') {\n      // If it's okay let's create a notification\n      return new window.Notification(text)\n\n    // Otherwise, we need to ask the user for permission\n    } else if (window.Notification.permission !== 'denied') {\n      window.Notification.requestPermission(function (permission) {\n        // If the user accepts, let's create a notification\n        if (permission === 'granted') {\n          return new window.Notification(text)\n        }\n      })\n    }\n  }\n\n  // show form\n  let ask = function (partial) {\n    ping()\n    notify('What are you doing?')\n\n    let html = Handlebars.templates.form(partial)\n    $('#forms').prepend(html)\n\n    $('.tag').typeahead({\n      hint: true,\n      highlight: true,\n      minLength: 1\n    }, {\n      name: 'tags',\n      source: substringMatcher(analyst.analyze(saturn.data()))\n    })\n\n    listen(partial)\n  }\n\n  let substringMatcher = function (strs) {\n    return function findMatches (q, cb) {\n      let matches, substrRegex\n\n      // an array that will be populated with substring matches\n      matches = []\n\n      // regex used to determine if a string contains the substring `q`\n      substrRegex = new RegExp(q, 'i')\n\n      // iterate through the pool of strings and for any string that\n      // contains the substring `q`, add it to the `matches` array\n      $.each(strs, function (i, str) {\n        if (substrRegex.test(str)) {\n          matches.push(str)\n        }\n      })\n\n      cb(matches)\n    }\n  }\n\n  // handle new-data form\n  let listen = function (partial) {\n    let form = $('#' + partial.id)\n\n    form.submit(function (event) {\n      event.preventDefault()\n\n      // get tag\n      let tag = form.find('.tag.tt-input').val()\n\n      // validate tag\n      if (tag.length === 0) {\n        form.addClass('has-error')\n        return false\n      }\n\n      // complete datum\n      partial.tag = tag\n\n      // send to saturn\n      saturn.add(partial)\n\n      // remove form\n      $('#' + partial.id).remove()\n    })\n  }\n\n  let saturn = new Saturn()\n  let analyst = new Analyst()\n\n  saturn.subscribe(render)\n\n  $('#clear').click(saturn.clear)\n\n  saturn.start({\n    prompt: ask,\n    minutes: 40,\n    askFirst: false\n  })\n\n  render(saturn.data())\n})\n"],"sourceRoot":"/source/"}